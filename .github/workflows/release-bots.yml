name: Release Liquidity Bots

on:
  workflow_dispatch: # adding the workflow_dispatch so it can be triggered manually
  push:
    tags:
      - 'bots-v*'

defaults:
  run:
    working-directory: batcher-bot/liquidity
jobs:
  release:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout code
        uses: actions/checkout@v2
      - name: Setup Node
        uses: actions/setup-node@v1
        with:
          node-version: '18.x'
      - name: Install modules
        run: npm install
      - name: Build
        run: npm run build
      - name: Release
        uses: softprops/action-gh-release@v1
        with:
          files: |
            ./batcher-bot/liquidity/dist/batcher-liquidity-bot.d.ts
            ./batcher-bot/liquidity/dist/batcher-liquidity-bot.js
            ./batcher-bot/liquidity/src/liquidity-config-example-ghostnet.json
            ./batcher-bot/liquidity/src/liquidity-config-example-mainnet.json
            README.md
